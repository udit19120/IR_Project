Loading data from ['cell_phones_digital_music', 'digital_music_cell_phones'] with batch size 1024...
Data loaded of train batch
Data loaded of dev batch for domain 0
Data loaded of dev batch for domain 1
user_num 713
item_num_domain0 4376
train data file0 : 5945, test data file0 : 326
item_num_domain1 3205
train data file1 : 7489, test data file1 : 575
making disencdr
making embeddings
2023-03-25 00:58:55.661722: step 14/700 (epoch 1/50), loss = 1316.080654 (5.091 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 1: train_loss = 1316.080654
domain 0 NDCG: 0.002501426002410211 HIT: 0.006134969325153374
domain 1 NDCG: 0.0070375284421048175 HIT: 0.01565217391304348
0.002501426002410211
new best model saved.

2023-03-25 00:59:10.647384: step 28/700 (epoch 2/50), loss = 1801.275096 (10.566 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 2: train_loss = 1801.275096
domain 0 NDCG: 0.0040351683336985545 HIT: 0.006134969325153374
domain 1 NDCG: 0.001997909930641847 HIT: 0.0052173913043478265
0.0040351683336985545
new best model saved.

2023-03-25 00:59:28.525147: step 42/700 (epoch 3/50), loss = 1815.711777 (12.590 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 3: train_loss = 1815.711777
domain 0 NDCG: 0.0013210937364214511 HIT: 0.003067484662576687
domain 1 NDCG: 0.007568252374336039 HIT: 0.019130434782608695
0.0040351683336985545

2023-03-25 00:59:43.954489: step 56/700 (epoch 4/50), loss = 1818.813854 (12.122 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 4: train_loss = 1818.813854
domain 0 NDCG: 0.008201645866306615 HIT: 0.015337423312883436
domain 1 NDCG: 0.004965892007914159 HIT: 0.010434782608695653
0.008201645866306615
new best model saved.

2023-03-25 00:59:58.433485: step 70/700 (epoch 5/50), loss = 1811.467620 (11.765 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 5: train_loss = 1811.467620
domain 0 NDCG: 0.0042541497154433795 HIT: 0.006134969325153374
domain 1 NDCG: 0.0012517241467674453 HIT: 0.0034782608695652175
0.008201645866306615

2023-03-25 01:00:17.264061: step 84/700 (epoch 6/50), loss = 1815.312008 (15.148 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 6: train_loss = 1815.312008
domain 0 NDCG: 0.0060145303380725115 HIT: 0.018404907975460124
domain 1 NDCG: 0.005876757699048322 HIT: 0.01217391304347826
0.008201645866306615

2023-03-25 01:00:31.978883: step 98/700 (epoch 7/50), loss = 1825.762093 (10.289 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 7: train_loss = 1825.762093
domain 0 NDCG: 0.010451323682726459 HIT: 0.024539877300613498
domain 1 NDCG: 0.004151048360407899 HIT: 0.008695652173913044
0.010451323682726459
new best model saved.

2023-03-25 01:00:47.652524: step 112/700 (epoch 8/50), loss = 1816.076059 (11.424 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 8: train_loss = 1816.076059
domain 0 NDCG: 0.010185491638076114 HIT: 0.015337423312883436
domain 1 NDCG: 0.0041035736813778674 HIT: 0.008695652173913044
0.010451323682726459

2023-03-25 01:01:01.812934: step 126/700 (epoch 9/50), loss = 1804.571874 (10.482 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 9: train_loss = 1804.571874
domain 0 NDCG: 0.005112474437627811 HIT: 0.009202453987730062
domain 1 NDCG: 0.004854957411772727 HIT: 0.010434782608695653
0.010451323682726459

2023-03-25 01:01:15.519493: step 140/700 (epoch 10/50), loss = 1801.061238 (10.808 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 10: train_loss = 1801.061238
domain 0 NDCG: 0.008151034302981605 HIT: 0.012269938650306749
domain 1 NDCG: 0.00577832132614786 HIT: 0.01217391304347826
0.010451323682726459

2023-03-25 01:01:33.617633: step 154/700 (epoch 11/50), loss = 1814.581159 (13.099 sec/batch), lr: 0.001000
Evaluating on dev set...
........epoch 11: train_loss = 1814.581159
domain 0 NDCG: 0.005020412649583032 HIT: 0.015337423312883436
domain 1 NDCG: 0.004793308224892679 HIT: 0.01391304347826087
0.010451323682726459

2023-03-25 01:01:52.469919: step 168/700 (epoch 12/50), loss = 1800.320176 (13.542 sec/batch), lr: 0.000900
Evaluating on dev set...
........epoch 12: train_loss = 1800.320176
domain 0 NDCG: 0.0060145303380725115 HIT: 0.012269938650306749
domain 1 NDCG: 0.0028985507246376808 HIT: 0.0052173913043478265
0.010451323682726459

2023-03-25 01:02:14.122099: step 182/700 (epoch 13/50), loss = 1805.746090 (16.756 sec/batch), lr: 0.000900
Evaluating on dev set...
........epoch 13: train_loss = 1805.746090
domain 0 NDCG: 0.002501426002410211 HIT: 0.006134969325153374
domain 1 NDCG: 0.007493805767649952 HIT: 0.01565217391304348
0.010451323682726459

2023-03-25 01:02:36.026614: step 196/700 (epoch 14/50), loss = 1808.074818 (15.254 sec/batch), lr: 0.000810
Evaluating on dev set...
........epoch 14: train_loss = 1808.074818
domain 0 NDCG: 0.005202360860865537 HIT: 0.012269938650306749
domain 1 NDCG: 0.002861342632045061 HIT: 0.0052173913043478265
0.010451323682726459

2023-03-25 01:02:55.965432: step 210/700 (epoch 15/50), loss = 1787.048973 (16.586 sec/batch), lr: 0.000810
Evaluating on dev set...
........epoch 15: train_loss = 1787.048973
domain 0 NDCG: 0.004403932378222323 HIT: 0.012269938650306749
domain 1 NDCG: 0.001917128038203729 HIT: 0.0052173913043478265
0.010451323682726459

2023-03-25 01:03:14.180703: step 224/700 (epoch 16/50), loss = 1798.519108 (14.447 sec/batch), lr: 0.000729
Evaluating on dev set...
........epoch 16: train_loss = 1798.519108
domain 0 NDCG: 0.005378306482278155 HIT: 0.012269938650306749
domain 1 NDCG: 0.005094910800586845 HIT: 0.01391304347826087
0.010451323682726459

2023-03-25 01:03:41.308034: step 238/700 (epoch 17/50), loss = 1811.237504 (18.665 sec/batch), lr: 0.000729
Evaluating on dev set...
........epoch 17: train_loss = 1811.237504
domain 0 NDCG: 0.005487928915085546 HIT: 0.009202453987730062
domain 1 NDCG: 0.00488713468789712 HIT: 0.01391304347826087
0.010451323682726459

2023-03-25 01:04:06.060939: step 252/700 (epoch 18/50), loss = 1802.906503 (18.891 sec/batch), lr: 0.000729
Evaluating on dev set...
........epoch 18: train_loss = 1802.906503
domain 0 NDCG: 0.0023435886239470136 HIT: 0.006134969325153374
domain 1 NDCG: 0.004779488562402309 HIT: 0.008695652173913044
0.010451323682726459

2023-03-25 01:04:29.777918: step 266/700 (epoch 19/50), loss = 1789.238351 (17.318 sec/batch), lr: 0.000656
Evaluating on dev set...
........epoch 19: train_loss = 1789.238351
domain 0 NDCG: 0.006378756957645568 HIT: 0.012269938650306749
domain 1 NDCG: 0.00859320717131641 HIT: 0.017391304347826087
0.010451323682726459

2023-03-25 01:04:51.504874: step 280/700 (epoch 20/50), loss = 1820.635435 (15.807 sec/batch), lr: 0.000656
Evaluating on dev set...
........epoch 20: train_loss = 1820.635435
domain 0 NDCG: 0.003734847555996345 HIT: 0.009202453987730062
domain 1 NDCG: 0.0024406584654454353 HIT: 0.006956521739130435
0.010451323682726459

2023-03-25 01:05:15.686785: step 294/700 (epoch 21/50), loss = 1815.228075 (19.529 sec/batch), lr: 0.000590
Evaluating on dev set...
........epoch 21: train_loss = 1815.228075
domain 0 NDCG: 0.00224449863109624 HIT: 0.006134969325153374
domain 1 NDCG: 0.00651502858236369 HIT: 0.008695652173913044
0.010451323682726459

2023-03-25 01:05:43.048686: step 308/700 (epoch 22/50), loss = 1806.184615 (20.794 sec/batch), lr: 0.000531
Evaluating on dev set...
........epoch 22: train_loss = 1806.184615
domain 0 NDCG: 0.005487928915085546 HIT: 0.009202453987730062
domain 1 NDCG: 0.0028674751480331517 HIT: 0.0052173913043478265
0.010451323682726459

2023-03-25 01:06:11.139939: step 322/700 (epoch 23/50), loss = 1796.530332 (20.737 sec/batch), lr: 0.000531
Evaluating on dev set...
........epoch 23: train_loss = 1796.530332
domain 0 NDCG: 0.006551948315332951 HIT: 0.015337423312883436
domain 1 NDCG: 0.004420152123188582 HIT: 0.008695652173913044
0.010451323682726459

2023-03-25 01:06:37.967519: step 336/700 (epoch 24/50), loss = 1809.037951 (20.627 sec/batch), lr: 0.000531
Evaluating on dev set...
........epoch 24: train_loss = 1809.037951
domain 0 NDCG: 0.004349121161818628 HIT: 0.009202453987730062
domain 1 NDCG: 0.002323889142332158 HIT: 0.006956521739130435
0.010451323682726459

2023-03-25 01:07:04.571704: step 350/700 (epoch 25/50), loss = 1816.164166 (22.227 sec/batch), lr: 0.000478
Evaluating on dev set...
........epoch 25: train_loss = 1816.164166
domain 0 NDCG: 0.005221833386565247 HIT: 0.009202453987730062
domain 1 NDCG: 0.006474937502740056 HIT: 0.01217391304347826
0.010451323682726459

2023-03-25 01:07:26.934883: step 364/700 (epoch 26/50), loss = 1793.006952 (16.606 sec/batch), lr: 0.000478
Evaluating on dev set...
........epoch 26: train_loss = 1793.006952
domain 0 NDCG: 0.0009676836711218674 HIT: 0.003067484662576687
domain 1 NDCG: 0.0006727874908426811 HIT: 0.0017391304347826088
0.010451323682726459

2023-03-25 01:07:45.656691: step 378/700 (epoch 27/50), loss = 1791.084522 (13.951 sec/batch), lr: 0.000430
Evaluating on dev set...
........epoch 27: train_loss = 1791.084522
domain 0 NDCG: 0.0033881279236307256 HIT: 0.009202453987730062
domain 1 NDCG: 0.004669858435544683 HIT: 0.010434782608695653
0.010451323682726459

2023-03-25 01:08:03.312778: step 392/700 (epoch 28/50), loss = 1808.631710 (13.788 sec/batch), lr: 0.000430
Evaluating on dev set...
........epoch 28: train_loss = 1808.631710
domain 0 NDCG: 0.004436793344653946 HIT: 0.009202453987730062
domain 1 NDCG: 0.003757492907310652 HIT: 0.008695652173913044
0.010451323682726459

2023-03-25 01:08:19.781531: step 406/700 (epoch 29/50), loss = 1801.444321 (13.399 sec/batch), lr: 0.000430
Evaluating on dev set...
........epoch 29: train_loss = 1801.444321
domain 0 NDCG: 0.0046296041929011125 HIT: 0.012269938650306749
domain 1 NDCG: 0.0017391304347826088 HIT: 0.0017391304347826088
0.010451323682726459

2023-03-25 01:08:38.375668: step 420/700 (epoch 30/50), loss = 1800.970039 (14.131 sec/batch), lr: 0.000430
Evaluating on dev set...
........epoch 30: train_loss = 1800.970039
domain 0 NDCG: 0.007172818191903122 HIT: 0.015337423312883436
domain 1 NDCG: 0.0005027214370745876 HIT: 0.0017391304347826088
0.010451323682726459

2023-03-25 01:08:54.888682: step 434/700 (epoch 31/50), loss = 1811.208465 (12.448 sec/batch), lr: 0.000430
Evaluating on dev set...
........epoch 31: train_loss = 1811.208465
domain 0 NDCG: 0.006095512087973864 HIT: 0.009202453987730062
domain 1 NDCG: 0.004939058196358313 HIT: 0.010434782608695653
0.010451323682726459

2023-03-25 01:09:11.812093: step 448/700 (epoch 32/50), loss = 1807.064711 (13.841 sec/batch), lr: 0.000387
Evaluating on dev set...
........epoch 32: train_loss = 1807.064711
domain 0 NDCG: 0.005346809798596822 HIT: 0.009202453987730062
domain 1 NDCG: 0.0011032405721692427 HIT: 0.0034782608695652175
0.010451323682726459

2023-03-25 01:09:26.045614: step 462/700 (epoch 33/50), loss = 1796.292691 (11.803 sec/batch), lr: 0.000349
Evaluating on dev set...
........epoch 33: train_loss = 1796.292691
domain 0 NDCG: 0.0 HIT: 0.0
domain 1 NDCG: 0.004165112426049015 HIT: 0.008695652173913044
0.010451323682726459

2023-03-25 01:09:43.039701: step 476/700 (epoch 34/50), loss = 1818.112644 (12.559 sec/batch), lr: 0.000314
Evaluating on dev set...
........epoch 34: train_loss = 1818.112644
domain 0 NDCG: 0.001979362004373957 HIT: 0.006134969325153374
domain 1 NDCG: 0.002765382299098903 HIT: 0.0052173913043478265
0.010451323682726459

2023-03-25 01:10:07.914155: step 490/700 (epoch 35/50), loss = 1786.234744 (19.978 sec/batch), lr: 0.000314
Evaluating on dev set...
........epoch 35: train_loss = 1786.234744
domain 0 NDCG: 0.002288777407543318 HIT: 0.006134969325153374
domain 1 NDCG: 0.0012524976357702173 HIT: 0.0034782608695652175
0.010451323682726459

2023-03-25 01:10:46.298573: step 504/700 (epoch 36/50), loss = 1800.043007 (27.650 sec/batch), lr: 0.000314
Evaluating on dev set...
........epoch 36: train_loss = 1800.043007
domain 0 NDCG: 0.0031325648350670433 HIT: 0.009202453987730062
domain 1 NDCG: 0.01162187118157121 HIT: 0.02434782608695652
0.010451323682726459

2023-03-25 01:11:22.629991: step 518/700 (epoch 37/50), loss = 1820.221687 (20.765 sec/batch), lr: 0.000314
Evaluating on dev set...
........epoch 37: train_loss = 1820.221687
domain 0 NDCG: 0.000923404894674789 HIT: 0.003067484662576687
domain 1 NDCG: 0.0011755089279172687 HIT: 0.0034782608695652175
0.010451323682726459

2023-03-25 01:11:46.447383: step 532/700 (epoch 38/50), loss = 1808.062583 (14.897 sec/batch), lr: 0.000282
Evaluating on dev set...
........epoch 38: train_loss = 1808.062583
domain 0 NDCG: 0.008781092967205006 HIT: 0.015337423312883436
domain 1 NDCG: 0.006844915715466607 HIT: 0.01391304347826087
0.010451323682726459

2023-03-25 01:12:10.302656: step 546/700 (epoch 39/50), loss = 1783.907682 (16.415 sec/batch), lr: 0.000282
Evaluating on dev set...
........epoch 39: train_loss = 1783.907682
domain 0 NDCG: 0.0038288525257095946 HIT: 0.009202453987730062
domain 1 NDCG: 0.0026012459915549574 HIT: 0.006956521739130435
0.010451323682726459

2023-03-25 01:12:29.191723: step 560/700 (epoch 40/50), loss = 1800.325713 (11.966 sec/batch), lr: 0.000254
Evaluating on dev set...
........epoch 40: train_loss = 1800.325713
domain 0 NDCG: 0.003122032395110427 HIT: 0.006134969325153374
domain 1 NDCG: 0.00231853011534684 HIT: 0.006956521739130435
0.010451323682726459

2023-03-25 01:12:47.550838: step 574/700 (epoch 41/50), loss = 1802.220790 (13.166 sec/batch), lr: 0.000229
Evaluating on dev set...
........epoch 41: train_loss = 1802.220790
domain 0 NDCG: 0.007227629408306816 HIT: 0.012269938650306749
domain 1 NDCG: 0.0015423527082339854 HIT: 0.0034782608695652175
0.010451323682726459

2023-03-25 01:13:06.876172: step 588/700 (epoch 42/50), loss = 1809.552392 (13.319 sec/batch), lr: 0.000229
Evaluating on dev set...
........epoch 42: train_loss = 1809.552392
domain 0 NDCG: 0.0021543487239885596 HIT: 0.006134969325153374
domain 1 NDCG: 0.0005235304272417064 HIT: 0.0017391304347826088
0.010451323682726459

2023-03-25 01:13:23.491378: step 602/700 (epoch 43/50), loss = 1813.693115 (11.183 sec/batch), lr: 0.000206
Evaluating on dev set...
........epoch 43: train_loss = 1813.693115
domain 0 NDCG: 0.006189517057687115 HIT: 0.012269938650306749
domain 1 NDCG: 0.006686403400034126 HIT: 0.01565217391304348
0.010451323682726459

2023-03-25 01:13:40.550530: step 616/700 (epoch 44/50), loss = 1820.656139 (12.445 sec/batch), lr: 0.000206
Evaluating on dev set...
........epoch 44: train_loss = 1820.656139
domain 0 NDCG: 0.0048122478221116795 HIT: 0.012269938650306749
domain 1 NDCG: 0.0046176255809610035 HIT: 0.010434782608695653
0.010451323682726459

2023-03-25 01:14:00.674602: step 630/700 (epoch 45/50), loss = 1817.769958 (16.321 sec/batch), lr: 0.000185
Evaluating on dev set...
........epoch 45: train_loss = 1817.769958
domain 0 NDCG: 0.0018543855923423825 HIT: 0.006134969325153374
domain 1 NDCG: 0.0018482964187599498 HIT: 0.0052173913043478265
0.010451323682726459

2023-03-25 01:14:20.367717: step 644/700 (epoch 46/50), loss = 1798.663728 (12.000 sec/batch), lr: 0.000167
Evaluating on dev set...
........epoch 46: train_loss = 1798.663728
domain 0 NDCG: 0.005002852004820422 HIT: 0.006134969325153374
domain 1 NDCG: 0.005515951415467393 HIT: 0.010434782608695653
0.010451323682726459

2023-03-25 01:14:36.765778: step 658/700 (epoch 47/50), loss = 1811.936072 (11.974 sec/batch), lr: 0.000167
Evaluating on dev set...
........epoch 47: train_loss = 1811.936072
domain 0 NDCG: 0.009907456399578206 HIT: 0.02147239263803681
domain 1 NDCG: 0.007587193577928403 HIT: 0.01217391304347826
0.010451323682726459

2023-03-25 01:14:52.707452: step 672/700 (epoch 48/50), loss = 1805.934287 (11.372 sec/batch), lr: 0.000167
Evaluating on dev set...
........epoch 48: train_loss = 1805.934287
domain 0 NDCG: 0.00833055844754692 HIT: 0.018404907975460124
domain 1 NDCG: 0.003847677172549642 HIT: 0.006956521739130435
0.010451323682726459

2023-03-25 01:15:06.935292: step 686/700 (epoch 49/50), loss = 1819.292540 (11.367 sec/batch), lr: 0.000150
Evaluating on dev set...
........epoch 49: train_loss = 1819.292540
domain 0 NDCG: 0.009689839300583671 HIT: 0.02147239263803681
domain 1 NDCG: 0.0019117690112184103 HIT: 0.0052173913043478265
0.010451323682726459

2023-03-25 01:15:20.206982: step 700/700 (epoch 50/50), loss = 1820.194637 (10.667 sec/batch), lr: 0.000150
Evaluating on dev set...
........epoch 50: train_loss = 1820.194637
domain 0 NDCG: 0.0010926600831534423 HIT: 0.003067484662576687
domain 1 NDCG: 0.004615310621471558 HIT: 0.010434782608695653
0.010451323682726459